module Assets.Screens exposing (testScreen1, testScreen2, testScreen3, testScreen4, testScreen5, testScreen6)

import Assets.Tiles as Tiles
import CollisionLayer exposing (CollisionLayer)
import Dict
import Levers
import Screen exposing (Screen)
import Size exposing (Size22x22, Size8x8)
import Tilemap exposing (Tilemap)


testScreen6 : Screen Size22x22 Size8x8
testScreen6 =
    """
    . . . . . . . . . . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . . . . . . . . . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . . . . . . . . . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . ▓ ▀ ▀ ▓ . . ▓ . . ▓ . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . ▓ . . ▓ . . ▓ . . ▓ . . . . . . . . . .
    . . ▓ . . ▓ . . ▓ . . ▓ . . . . . . . . . .
    ▀ ▀ ▓ . . ▓ . . ▓ . . ▓ . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ . . . . . . . . . . . . ▒ ▒
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . ▓ . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . ▓ . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    ▓ . . . . . ▀ ▀ ▀ ▀ . . ▀ ▀ ▀ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . . . . . . △ ▓ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . . . ◍ ◍ . ▯ ▓ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    """
        |> toScreen


testScreen5 : Screen Size22x22 Size8x8
testScreen5 =
    """
    ▓ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ . . . . ▒ ▒ ▓ ▓ ▓ ▓ ▓ ▓ ▓ . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . . . ▓ ▓ ▓ . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▒ ▒ ▒ ▓ ▓ . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ ▀ . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . ▚ ▚ ▚ ▚ . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . ▓ ▓ ▓ ▓ ▚ ▚ ▚ ▚
    ▓ . ▀ ▓ . . . . . . . . . . ▓ ▓ ▓ ▓ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . ▚ ▚ ▚ ▚ . ▓ ▓ ▓ ▓ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ ▀ . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ ▚ ▚ ▚ ▚ . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . ▀ ▓ . . . . . . ◍ ◍ . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . ▚ ▚ ▚ ▚ . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ ▀ . ▓ . . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ ▚ ▚ ▚ ▚ . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . ▀ ▓ . . . . . ▚ ▚ ▚ ▚ . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    """
        |> toScreen


testScreen4 : Screen Size22x22 Size8x8
testScreen4 =
    """
    ▓ . . ▓ . . . . . ▚ ▚ ▚ ▚ . . ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ ▀ . ▓ . . . . . . . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . . ◍ ◍ . . . . ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    ▓ . . ▓ . . . ▓ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚ ▚
    . . ▀ ▓ . . . ▓ ▓ . . . . . . . . . . . . .
    . . . ▓ . . . ▓ ▓ . . . . . . . . . . . . .
    . . . ▓ . ▀ ▀ ▓ ▓ . . . . . . . . . . . . .
    ▓ ▓ ▓ ▓ . . . ▓ ▓ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ . . . ▓ ▓ . . . ▀ ▀ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ ▀ ▀ . ▓ ▓ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ . . . ▓ ▓ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . ▀ . . . ▀ ▀ . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . ▀ ▀ ▀ ▀ ▀ . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . ▀ ▀ ▀ ▀ . . ▀ ▀ ▀ ▀ . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . ▀ ▀ ▀ ▀ . . . . . . .
    """
        |> toScreen


testScreen3 : Screen Size22x22 Size8x8
testScreen3 =
    """
    . . . . . . . . . . . ▀ ▀ ▀ ▀ . . . . . . .
    . . . . . . . ▀ ▀ . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . ▀ ▀ . . ▀ ▀ . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . ▀ . . . ▀ ▀ . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . ▀ ▀ ▀ ▀ ▀ . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . ▀ ▀ ▀ ▀ . . ▀ ▀ ▀ ▀ . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . ▀ ▀ . . ▀ ▀ ▀ ▀ . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . . . . ▀ ▀ . . ▀ ▀ . . . . . . . . . . .
    . . . . . . . . . . . . . . . . . . . . . .
    . . ▓ ▓ . . . . . . . . . . . . . . . . . .
    . . ▓ ▒ ▒ ▒ ▒ . . . . . . . . . . . . . . .
    """
        |> toScreen


testScreen2 : Screen Size22x22 Size8x8
testScreen2 =
    """
    . . ▓ ▒ ▒ ▒ ▒ . . . . . . . . . . . . . . .
    . . . . . ▓ ▓ . . . . . . . . . . . . . . .
    . . . . . ▓ ▒ ▒ ▒ ▒ . . . . ╥ . . . . . . .
    . . . . . . . . ▓ ▓ . . . . ║ . . . . . . .
    . . . . ╥ . . . ▓ ▒ ▒ ▒ ▒ . ║ . . . . . . .
    . ◍ ◍ . ║ . . . . . . ▓ ▓ . ╨ . . . . . . .
    ▒ ▒ ▒ ▒ ║ . . . . . . ▓ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . ▓ ▓ ╨ . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . ▓ ▒ ▒ ▒ ▒ . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . ▓ ▓ . ◍ ◍ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . ▓ ▒ ▒ ▒ ▒ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . ╥ ▓ ▓ . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . ║ ▓ ▓ . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . . . . . ▒ ▒ ▒ ▒ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . . ◍ ◍ . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    . . . . . . . . . ▒ ▒ ▒ ▒ ▓ . . . . . . . .
    . . . . . . . . . ▓ ▓ ▓ ▓ ▓ . . . . . . . .
    . . . . . . ▒ ▒ ▒ ▒ ▓ . . . . . . . . . . .
    . . . . . . ▓ ▓ ▓ ▓ ▓ . . . . . . . . . . .
    . . . . . . ▓ ▓ ▓ ▓ ▓ . . . . . . . . . . .
    . . . ▒ ▒ ▒ ▒ ▓ . . . . . . . . . . . . . .
    """
        |> toScreen


testScreen1 : Screen Size22x22 Size8x8
testScreen1 =
    """
    . . . ▒ ▒ ▒ ▒ ▓ . . . . . . . . . . . . . .
    . . . ▓ ▓ ╥ . . . . . . . . . . . . . . . .
    ▓ ▓ ▓ ▓ . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ . . . . . . . . . . △ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ . . . . . . . . . . ▯ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒
    . . . ▓ . ▒ . . . . . . . . . . . . . . . .
    . . . ▓ . . . . . . . . . . . . . . . . . .
    ▓ ▓ ▒ . . . . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ╥ . . . . . . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ║ . . . ◍ ◍ . . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ . . . . ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ . . . . . . ╥ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ . . . . . . ║ . . . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▒ ▒ ▒ ▒ ▓ ▓ ╨ ◍ ◍ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ . . . . ▓ ▒ ▒ ▒ ▒ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ △ . . . . ╥ . . . ╥ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▯ . . . . ║ . . . ║ . . . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▒ ▒ ▒ ▒ . ╨ . . . ╨ . ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▒ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓ ▓
    """
        |> toScreen



-- INTERNAL


toScreen string =
    let
        tilemap =
            string
                |> Tilemap.fromString charTiles
                |> Maybe.withDefault (Tilemap.empty8x8Tile 0 0)

        collisionLayer =
            string
                |> CollisionLayer.fromString
                    (Dict.keys charTiles
                        |> List.filter isSolid
                    )
                |> Maybe.withDefault (CollisionLayer.empty Levers.screenWidthInTiles Levers.screenHeightInTiles)
    in
    Screen.make22x22 tilemap collisionLayer
        |> Maybe.withDefault Screen.error22x22


charTiles =
    Dict.fromList
        [ ( '.', Tiles.empty )
        , ( '▓', Tiles.dirt )
        , ( '▒', Tiles.brick )
        , ( '▀', Tiles.grass )
        , ( '▚', Tiles.stone )
        , ( '╥', Tiles.pillarTop )
        , ( '║', Tiles.pillarMiddle )
        , ( '╨', Tiles.pillarBottom )
        , ( '◍', Tiles.bush )
        , ( '△', Tiles.doorTop )
        , ( '▯', Tiles.doorBottom )
        ]


isSolid : Char -> Bool
isSolid ch =
    [ '.', '╥', '║', '╨', '◍', '△', '▯' ]
        |> List.member ch
        |> not
